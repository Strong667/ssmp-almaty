## Описание проекта

**SSMP Almaty** - официальный сайт государственного учреждения с админ-панелью для управления контентом.

### Основные функции:
- **Публичный сайт**: главная страница с новостями, информацией об администрации, графике приёма граждан, структуре организации, миссии и ценностях
- **Админ-панель MoonShine**: управление контентом через удобный интерфейс
- **Управление новостями**: создание, редактирование новостей с изображениями и видео
- **Галерея изображений**: управление изображениями для главной страницы
- **Управление администрацией**: информация о руководстве организации
- **График приёма граждан**: расписание приёма посетителей
- **Структура организации**: информация о подразделениях
- **Миссия и ценности**: описание миссии и ценностей организации

### Архитектура:
- **Backend**: Laravel 12 + MoonShine 4.0 (админ-панель)
- **Frontend**: Blade шаблоны + Bootstrap 5.3.3 + Vite
- **База данных**: MySQL с миграциями Laravel

## План обзора проекта (2025-11-11)

- [x] Собрать ключевые артефакты (маршруты, контроллеры, модели, ресурсы MoonShine)
- [x] Разобрать фронтенд-шаблоны и компоненты
- [x] Проанализировать миграции и структуру данных
- [x] Сформировать описание назначения проекта и основных функций
- [x] Подготовить обзор возможностей MoonShine-админки

## План по главной странице

- [ ] Сформировать минимально необходимую структуру данных главной страницы (название, описания секций, контакты, блоки «О нас», «Администрация», «График приёма» и др.) и согласовать с бэком MoonShine.
- [ ] Создать миграцию и модель `LandingPage` с заполнителями и кастами для сложных полей.
- [ ] Реализовать сервис `LandingPageService` для чтения данных модели с соблюдением принципов SOLID.
- [ ] Подготовить контроллер/маршрут для выдачи данных главной страницы на фронт.
- [ ] Сверстать стартовый Blade-шаблон главной страницы на основе новой модели данных.

## План по переделке фронтенда в стиле Aventro

- [x] Обновить header в стиле Aventro: современный дизайн, sticky навигация, плавные переходы.
- [x] Создать hero секцию с большим заголовком и CTA кнопками в стиле Aventro.
- [x] Переделать секции новостей, видео и карты в современном стиле с карточками.
- [x] Обновить footer в стиле Aventro с современной типографикой.
- [x] Добавить глобальные стили и анимации в стиле Aventro.

## Версии технологий

### Backend
- **PHP**: ^8.2 (текущая версия: 8.4.13)
- **Laravel Framework**: ^12.0 (текущая версия: 12.37.0)
- **MoonShine**: ^4.0 (текущая версия: 4.0.1)
- **MoonShine TinyMCE**: ^2.0

### Frontend
- **Bootstrap**: 5.3.3 (подключен через CDN)
- **Bootstrap Icons**: через CDN
- **Vite**: ^7.0.7 (для сборки ассетов)
- **Tailwind CSS**: ^4.0.0 (через Vite плагин)
- **Axios**: ^1.11.0
- **Blade**: шаблонизатор Laravel

### База данных
- **MySQL**: основная БД
- **Миграции**: Laravel migrations для управления схемой БД

### Объяснение версий

**Laravel 12** - последняя мажорная версия фреймворка с улучшенной производительностью и новыми возможностями.

**MoonShine 4.0** - значительное обновление админ-панели с новой архитектурой:
- Поля определяются в страницах (метод `fields()`), а не в ресурсах
- Изменена структура ресурсов - методы `indexFields()`, `formFields()` перенесены в страницы
- Удален метод `searchable()` для полей - поиск настраивается через метод `search()` в ресурсе
- Изменена конфигурация аутентификации - `auth.middleware` должен быть массивом
- Требуется явное указание кастомных страниц через метод `pages()` в ресурсе

**PHP 8.2+** - современная версия PHP с улучшенной производительностью и поддержкой новых возможностей языка.

## Текущая структура проекта

ssmp-almaty/
├── app/                                    // PHP код приложения
│   ├── Console/Commands/
│   │   └── DebugSettingPayload.php        // команда для отладки
│   ├── Http/Controllers/
│   │   ├── Controller.php                 // базовый контроллер
│   │   ├── Frontend/
│   │   │   └── HomeController.php         // контроллер главной страницы, загружает новости и изображения
│   │   └── Storage/
│   │       └── PublicStorageController.php // контроллер для публичной раздачи файлов из storage
│   ├── Models/                             // Eloquent модели
│   │   ├── Admin.php                       // модель администрации (full_name, position, email, image)
│   │   ├── CitizenSchedule.php            // модель графика приёма граждан (full_name, position, day, time)
│   │   ├── MissionValue.php               // модель миссии и ценностей (title, description)
│   │   ├── News.php                        // модель новостей (title, slug, description, video_url, image, published_at)
│   │   ├── Setting.php                    // модель настроек (main_image для галереи)
│   │   ├── Structure.php                   // модель структуры (title, image)
│   │   └── User.php                        // модель пользователей Laravel
│   ├── MoonShine/                          // кастомизация MoonShine-админки
│   │   ├── Layouts/
│   │   │   └── MoonShineLayout.php         // макет панели управления с меню "Главный экран" и "О нас"
│   │   ├── Pages/                           // кастомные страницы для ресурсов
│   │   │   ├── Dashboard.php                // дашборд MoonShine
│   │   │   ├── MoonShineUser/               // страницы для управления пользователями админки
│   │   │   │   ├── MoonShineUserIndexPage.php
│   │   │   │   └── MoonShineUserFormPage.php
│   │   │   └── MoonShineUserRole/           // страницы для управления ролями
│   │   │       ├── MoonShineUserRoleIndexPage.php
│   │   │       └── MoonShineUserRoleFormPage.php
│   │   └── Resources/                      // ресурсы MoonShine (CRUD для моделей)
│   │       ├── Admin/                       // CRUD администрации
│   │       │   └── AdminResource.php
│   │       ├── CitizenSchedule/             // CRUD графика приёма граждан
│   │       │   └── CitizenScheduleResource.php
│   │       ├── MissionValue/                // CRUD миссии и ценностей
│   │       │   └── MissionValueResource.php
│   │       ├── MoonShineUser/               // CRUD админ-пользователей (использует кастомные страницы)
│   │       │   └── MoonShineUserResource.php
│   │       ├── MoonShineUserRole/           // CRUD ролей (использует кастомные страницы)
│   │       │   └── MoonShineUserRoleResource.php
│   │       ├── News/                        // CRUD новостей
│   │       │   └── NewsResource.php
│   │       ├── Setting/                     // CRUD настроек (галерея изображений)
│   │       │   └── SettingResource.php
│   │       └── Structure/                   // CRUD структуры
│   │           └── StructureResource.php
│   ├── Providers/
│   │   ├── AppServiceProvider.php           // сервис-провайдер приложения
│   │   └── MoonShineServiceProvider.php     // регистрация ресурсов MoonShine
│   └── Services/
│       └── Storage/
│           └── PublicStorageService.php     // сервис для раздачи публичных файлов
├── config/                                  // конфигурационные файлы
│   ├── auth.php                            // конфигурация аутентификации (добавлен guard 'moonshine')
│   ├── filesystems.php                     // конфиг дисков: публичный корень /storage
│   └── moonshine.php                       // конфигурация MoonShine 4.0
├── database/migrations/                     // миграции БД
│   ├── 0001_01_01_000000_create_users_table.php
│   ├── 0001_01_01_000001_create_cache_table.php
│   ├── 0001_01_01_000002_create_jobs_table.php
│   ├── 2020_10_04_115514_create_moonshine_roles_table.php
│   ├── 2020_10_05_173148_create_moonshine_tables.php
│   ├── 2025_11_10_144815_create_notifications_table.php
│   ├── 2025_11_10_152732_create_settings_table.php
│   ├── 2025_11_11_113824_create_news_table.php
│   ├── 2025_11_11_200000_add_slug_to_news_table.php // добавление slug с уникальным индексом
│   └── 2025_11_11_201500_update_news_fields.php    // замена content на description и video_url
├── public/                                  // публичная директория
│   ├── slujba.png                          // логотип для хедера
│   └── build/                              // скомпилированные Vite ассеты
│       ├── manifest.json
│       └── assets/
├── resources/                               // исходники фронтенда
│   ├── css/app.css                         // глобальные стили Vite
│   ├── js/
│   │   ├── app.js                          // JS-энтрипойнт (Vite)
│   │   └── bootstrap.js                    // Bootstrap инициализация
│   └── views/                              // Blade-шаблоны фронтенда
│       ├── frontend/
│       │   ├── components/
│       │   │   ├── footer.blade.php         // футер с контактами и кнопкой "Наверх"
│       │   │   └── header.blade.php        // прозрачный header с навигацией и переключателем темы
│       │   ├── layouts/
│       │   │   └── app.blade.php           // общий каркас страниц (header, main, footer, JS для темы и скролла)
│       │   └── home.blade.php              // главная страница: hero секция, новости (карусель), видео/карта, галерея
│       └── welcome.blade.php                // стандартная заглушка Laravel
├── routes/
│   └── web.php                             // веб-маршруты: главная, storage/{path} для публичных файлов
├── storage/app/public/                     // публичные файлы
│   ├── main/                               // изображения галереи
│   └── news/                               // изображения новостей
└── tasks/
    └── todo.md                             // текущий план/заметки

## Review

- Обновлён `resources/views/frontend/layouts/app.blade.php`: у тега `body` обнулён margin, чтобы фон хедера тянулся во всю ширину.
- Файл `slujba.png` перенесён в `public/slujba.png`, чтобы можно было подгружать логотип из Blade-шаблонов.
- Подключён Bootstrap 5.3.3 и Bootstrap Icons через CDN в `resources/views/frontend/layouts/app.blade.php`, чтобы использовать готовые UI-компоненты.
- Полностью переработан `resources/views/frontend/components/header.blade.php`: задействованы Bootstrap-компоненты (navbar, grid, формы), добавлены иконки Bootstrap Icons; в шапке оставлен только крупный логотип, селектор языка и поиск, навигация — через collapse.
- Обновлён `resources/views/frontend/components/footer.blade.php`: вынесены контакты (адрес, email, телефоны, call-центр) в отдельные колонки, добавлена форма подписки, использованы цвета и сетка Bootstrap.
- Обновлён `HomeController` и `frontend/home.blade.php`: вместо текста выводится сетка изображений из записей `settings`, данные сортируются по дате обновления.
- Обновлён `SettingResource`: убраны поля заголовка и описания, оставлена загрузка изображения и обновлена валидация (проверка файла/типа); админка работает как галерея, убран недоступный метод `rounded()`.
- Для галереи изображения получают корректный публичный URL через `Storage::disk('public')->url(...)`; диск `public` переопределён на относительный путь (`/storage`), кеш конфигурации очищен, чтобы браузер не обращался к `http://localhost`.
- На главной вместо сетки теперь бесконечная горизонтальная витрина: изображения дублируются, прокручиваются CSS-анимацией (останавливается при hover), адаптируются под ширину экрана; секция без фона, сверху в одной строке стоят блоки YouTube и карта одинакового размера.
- Привёл `NewsResource::beforeCreating/beforeUpdating` к сигнатуре MoonShine (`mixed $item): mixed`) и возвращаю модель после генерации slug.
- `HomeController` подгружает последние новости (`News`) с публичными URL изображений, `home.blade.php` выводит их сеткой карточек с картинкой и датой.
- Фронтенд полностью переделан в стиле Aventro: header с sticky навигацией и плавными переходами, hero секция с градиентным фоном и CTA кнопками, секции новостей/видео/карты в виде современных карточек с тенями и hover-эффектами, footer в тёмном стиле с колонками навигации и контактов, добавлены глобальные стили с шрифтом Poppins и плавной прокруткой, мобильная адаптация с выезжающим меню.
- Добавлен переключатель темы (темный/светлый режим): кнопка в header с иконками солнца/луны, автоматическое определение системной темы, сохранение выбора в localStorage, адаптированные стили для всех секций в темной теме.
- Header сделан прозрачным с эффектом blur: по умолчанию `rgba(255, 255, 255, 0.1)` с `backdrop-filter: blur(10px)`, при скролле > 100px затемняется до `rgba(255, 255, 255, 0.95)`, белый текст с тенью в прозрачном состоянии, темный текст при скролле, адаптировано для темной темы.
- Добавлена кнопка "Наверх" (Masthead): фиксированная позиция в правом нижнем углу, появляется при скролле > 300px, плавная прокрутка наверх при клике, адаптирована для мобильных устройств, работает в обеих темах.
- Hero секция получила CSS паттерн с точками и шестиугольниками: сетка точек разного размера через radial-gradient, шестиугольники через repeating-linear-gradient под углами 0°/60°/120°, эффект перспективы через transform: perspective(), полупрозрачные элементы поверх градиентного фона.
- Таблица `news` обновлена: добавлено поле `slug` с уникальным индексом и автогенерацией для кириллицы, поля `description` и `video_url` вместо `content`, формат даты изменён на русский с месяцем прописью (например, "28 октября, 2025").
- Новости отображаются в горизонтальном карусельном формате: заголовок "НОВОСТИ" слева сверху, карточки фиксированной ширины (380px) с горизонтальной прокруткой, каждая карточка содержит изображение, заголовок, дату и кнопку "Читать Новость".
- Создан `PublicStorageService` и маршрут `storage/{path}` для публичной раздачи файлов из `storage/app/public`, отключена автогенерация защищённого маршрута для приватного диска в `config/filesystems.php`.
- Ресурсы `SettingResource` и `NewsResource` сгруппированы в меню MoonShine под разделом "Главный экран" в `MoonShineLayout.php`.
- Обновление MoonShine с версии 3 на версию 4: добавлен guard 'moonshine' в `config/auth.php` с provider и password reset broker для корректной работы аутентификации; исправлены типы возвращаемых значений в `NewsResource` (array -> iterable, методы сделаны protected) для совместимости с MoonShine 4; исправлен `auth.middleware` в `config/moonshine.php` (должен быть массивом `[Authenticate::class]`); исправлены сигнатуры методов `rules()` и `saving()` в `NewsResource` (параметры должны быть `mixed`, методы должны быть `protected`); удален метод `searchable()` из полей - поиск настроен через метод `search()` в ресурсе; созданы кастомные страницы для `MoonShineUserResource` и `MoonShineUserRoleResource` (`app/MoonShine/Pages/MoonShineUser/*` и `app/MoonShine/Pages/MoonShineUserRole/*`) для использования кастомных ресурсов вместо ресурсов из vendor; удалены методы `indexFields()`, `formFields()`, `detailFields()` из ресурсов - поля теперь определяются в страницах через метод `fields()`; все ресурсы проверены на совместимость с новой версией.
- Создана модель `EthicalCode` с полями `title` и `pdf_path`: исправлена миграция (поле `pdf_path` сделано nullable); исправлены namespace полей в `EthicalCodeFormPage` (использованы правильные классы `MoonShine\UI\Fields\*`); добавлены поля в `EthicalCodeIndexPage` и `EthicalCodeDetailPage` (ID, Text, File); добавлен метод `pages()` в `EthicalCodeResource` для указания кастомных страниц; модель обновлена с добавлением метода `casts()` для дат; создан метод `ethicalCode()` в `AboutController` для загрузки данных с публичными URL PDF файлов; добавлен маршрут `/about/ethical-code`; создан Blade шаблон `frontend/about/ethical-code.blade.php` для отображения списка документов этического кодекса с возможностью скачивания PDF файлов.
- Обновлена главная страница `HomePage`: добавлена форма обратной связи с использованием `FormBuilder`, полей `Email`, `Text`, `Textarea` и кнопки `ActionButton`; добавлены дополнительные компоненты MoonShine для наглядности: `Div` для группировки элементов, `Flex` для горизонтального размещения ссылок, `Link` с иконками для навигации; структура фронтенда объяснена: главная страница создана через класс `HomePage`, который расширяет `Page` и использует `GuestLayout` для отображения публичных страниц, компоненты возвращаются через метод `components()` в виде массива `ComponentContract`; форма использует `FormMethod::POST` enum и настроена на отправку на маршрут `home`.

